generator client {
  provider = "prisma-client"            
  output   = "../src/generated/prisma"  
}

datasource db {
  provider = "postgresql"
}

enum UserRole {
  admin
  user
}

enum AccountStatus {
  active
  inactive
  suspended
  pending_verification
}


enum OTPType {
  email_verification
  login_verification
  password_reset
  two_factor
}



model User {
  id                    String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email                 String           @unique
  username              String?          @unique
  firstName             String
  lastName              String
  displayName           String?
  role                  UserRole         @default(user)
  status                AccountStatus    @default(pending_verification)
  password              String
  emailVerifiedAt       DateTime?
  bio                   String?
  avatarUrl             String?
  isDeleted             Boolean          @default(false)
  lastLoginAt           DateTime?
  createdAt             DateTime         @default(now())
  updatedAt             DateTime         @default(now()) @updatedAt
  deletedAt             DateTime?
  otps                  OTP[]
}

model OTP {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  identifier String
  code       Int
  type       OTPType
  expiresAt  DateTime
  verified   Boolean  @default(false)
  attempts   Int      @default(0)
  userId     String?  @db.Uuid
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
  user       User?    @relation(fields: [userId], references: [id], onDelete: SetNull)

  @@index([identifier, type, verified])
  @@index([expiresAt])
  @@index([userId])
  @@index([createdAt])
}

model Product {
  id          String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name        String
  description String
  price       Float
  quantity    Int
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
}

model Category {
  id          String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name        String
  description String?
  status      String      
  createdAt   DateTime    @default(now())
  updatedAt   DateTime    @updatedAt
}